Title: mdcode Coverage Plan to 98% — 2025-10-30

Goal
- Raise automated line coverage to ≥98% (Tarpaulin) with stable, fast tests.

Constraints
- No network calls; use local temp repos and bare remotes.
- Avoid invasive code changes; prefer unit tests exercising private helpers via the existing tests module.

Plan (Multi‑Stage)
1) Utilities & Launchers (quick wins)
   - Tests: direct `launch_program_with_args` success/failure; `launch_custom_diff_tool` success using a portable Unix stub (gated by `#[cfg(unix)]`).
   - Outcome: cover success/failure branches and logging for process spawn helpers.

2) GitHub CLI Detection
   - Tests: `gh_cli_path` returns `None` when `MDCODE_DISABLE_GH_CLI=1`; retain PATH-based detection via existing end-to-end test.
   - Outcome: explicit coverage of disable gate.

3) Trees & Commits
   - Tests: `checkout_tree_to_dir` copies nested trees and file blobs; `get_last_commit` errors on an empty repo; `get_last_commit` succeeds on a repo with an initial commit.
   - Outcome: cover recursive copy and commit lookup edges.

4) (Optional) Additional Edges
   - Consider synthetic failure for `gh_fetch`’s `git log` subcommand; implement only if needed to cross 98%.

Execution Checklist
- Add tests inline under `#[cfg(test)]` in `src/main.rs` to access private helpers.
- Run: `cargo test` (CI: `make coverage` when toolchains are available).
- If coverage <98%, iterate on Stage 4 to close remaining gaps.

Validation
- Passing test suite with added cases.
- Coverage increase observed in CI via `Makefile` targets and `scripts/coverage_gate.py` (when tools are available).

