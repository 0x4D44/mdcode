# Journal — Coverage Refactor (Lib Split, Test Reorg, 98%)
Date: 2025-10-31
Author: md

## Entry 1 — Stage A (prep)
- Added Rust check-cfg lint in Cargo.toml to recognize `cfg(tarpaulin)` and eliminate unexpected_cfg warnings.
- Updated Makefile:
  - `coverage-llvm` now uses `cargo llvm-cov --lib` to scope coverage to the library target.
  - Added `coverage-detailed` to export detailed JSON for local triage.
- Next: validate build, tests, and coverage; record metrics.

## Commands to run
- `cargo test`
- `make coverage`
- Optional: `make coverage-detailed`


## Entry 2 — Stage A validation and fix
- Ran `cargo test`: 18 passed.
- Ran `make coverage`: Tarpaulin succeeded; LLVM `--lib` failed because no lib target exists yet.
- Updated Makefile to conditionally pass `--lib` only when `src/lib.rs` exists.
- Next: Proceed to Stage B (create `src/lib.rs`) so LLVM lib-only coverage engages.
